@using Northwind.Models
@model IEnumerable<Order>

<table class="table table-hover">
    <thead>
        <tr>
            <th scope="col">
                <div class="form-row">
                    <div class="form-group col-md-4 mb-0">
                        <div class="form-check text-right">
                            <input class="form-check-input" type="checkbox" id="Shipped">
                            <label class="form-check-label" for="Shipped">Shipped</label>
                        </div>
                    </div>
                </div>
            </th>
        </tr>
        <tr>
            <th scope="col">Order ID</th>
            <th scope="col">Customer</th>
            <th scope="col">Employee</th>
            <th scope="col">Order Date</th>
            <th scope="col">Required Date</th>
            <th scope="col">Shipping Address</th>
</thead>
    <tbody id="product_rows">
    </tbody>
</table>

@section scripts
{
    <script>// Turn off ESLint (Windows): Tools - Options - Text Editor - Javascript - Linting
        $(function () {
            getOrders()

            function getOrders() {
                // var shipped = $('#Shipped').prop('checked') ? "" : "/shipped/false";
                $.getJSON({
                    url: "../../api/order/",
                    success: function (response, textStatus, jqXhr) {
                        //console.log(response);
                        $('#product_rows').html("");
                        for (var i = 0; i < response.length; i++) {
                            // var css = response[i].shipped ? " class=\"shipped\"" : "";
                            var row = "<tr>"
                                + "<td>" + response[i].OrderId + "</td>"
                                + "<td>" + response[i].Customer.FirstName + response[i].Customer.LastName + "</td>"
                                + "<td>" + response[i].Employee.FirstName + response[i].Employee.LastName + "</td>"
                                + "<td>" + response[i].OrderDate + "</td>"
                                + "<td>" + response[i].RequiredDate + "</td>"
                                + "<td>"
                                    + response[i].ShipAddress
                                    + response[i].ShipCity
                                    + response[i].ShipRegion
                                    + response[i].ShipPostalCode
                                    + response[i].ShipCountry
                                + "</td>"
                                + "</tr>";
                            $('#product_rows').append(row);
                        }
                    },
                    error: function (jqXHR, textStatus, errorThrown) {
                        // log the error to the console
                        console.log("The following error occured: " + textStatus, errorThrown);
                    }
                });
            }

            $('#CategoryId').on('change', function () {
                $('#product_rows').data('id', $(this).val());
                getProducts();
            });

            $('#Discontinued').on('change', function () {
                getProducts();
            });
        });</script>
}